<!DOCTYPE html> 
<html> 
<head> 
	<meta charset="utf-8">

	<!-- Sets initial viewport load and disables zooming  -->
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no">
    <!-- Makes your prototype chrome-less once bookmarked to your phone's home screen -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">

	<style>
		.content-frame {
			padding: 0 25px;
		}
		#img-result {
			width: 100%;
		}
		ul.list.inset {
			margin: 0 0 25px 0;
		}
		#description-block {
			margin-bottom: 25px;
		}
	</style>
	<link rel="stylesheet" href="css/ratchet.css" />
	<script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
	<script src="http://www.parsecdn.com/js/parse-1.1.5.min.js"></script>
	<script src="js/ratchet.js"></script>
	<script type="text/javascript">
	var userInput;
	var MenuIems;
	var menuItems;
	var file;
		$(document).ready(function(){
		
		$('#fileselect').bind("change", function(e) {
			alert("come here");
		    var files = e.target.files || e.dataTransfer.files;
		    // Our file var now holds the selected file
		    file = files[0];
		});
		
		$('#uploadbutton').click(function() {
		
		    var serverUrl = 'https://api.parse.com/1/files/' + file.name;
	
		    $.ajax({
		       type: "POST",
		       beforeSend: function(request)
		       {
			    request.setRequestHeader("X-Parse-Application-Id", 'disyUernrft5qEpSxF0Kwye2tvVrtUNpGrq3Jesc');
			    request.setRequestHeader("X-Parse-REST-API-Key", 'LrjIhvEWgAPh2gsmByFKxfwQ8OhOKYdAnFkhJGzc');
			    request.setRequestHeader("Content-Type", file.type);
			},
			url: serverUrl,
			data: file,
			processData: false,
			contentType: false,
			success: function(data)
			{
			    alert("in success");
			    alert("File available at " + data.url);
			},
			error: function(data) {
			    alert("in error");
			   var obj = jQuery.parseJSON(data);
			   alert(obj.error);
			}
		    });
			
			
		 });
		 
		 $("#submit").click(function(){
				Parse.initialize("disyUernrft5qEpSxF0Kwye2tvVrtUNpGrq3Jesc", "qArEBKrhqQDdXICMjXvcOSYHdNyHdj0gYvsFPyZY");
				window.MenuItems = Parse.Object.extend("MenuItems");
				menuItems=new MenuItems();
				
				userInput=document.getElementById("description").value+"#description#"+
						document.getElementById("ingredient").value+"#ingredient#"+
						document.getElementById("category").value+"#category#"+
						document.getElementById("country").value+"#country#";
			
				var name=document.getElementById("name").value;
				menuItems.set("Description",userInput);
				menuItems.set("Name",name);
				menuItems.set("Likes",0);
				menuItems.set("Dislikes",0);
				menuItems.save(null,{
						success: function(menuItems){
							alert("Data saved successfully"); //should change these to jquery alerts.
						},
						error: function(menuItems,error){
							alert("Could not save data");
						}
					});
			});
			
		});
	
	function initialParse()
	{
		Parse.initialize("disyUernrft5qEpSxF0Kwye2tvVrtUNpGrq3Jesc", "qArEBKrhqQDdXICMjXvcOSYHdNyHdj0gYvsFPyZY");
		window.MenuItems = Parse.Object.extend("MenuItems");
	}
	
	</script>
	
</head>
<body onload="initialParse()">
	<header class="bar-title">
            <h1 class="title">Picture This</h1>
        </header>
	
	<div id="home" class="content">
		<form id="fileupload" name="fileupload" enctype="multipart/form-data" method="post">
			<div class="input-group">
				<input type="text" id="name" placeholder="Dish Name">
				<input type="text" id="description" placeholder="Description">
				<input type="text" id="ingredient" placeholder="Main Ingredient">
				<input type="text" id="category" placeholder="Category">
				<input type="text" id="country" placeholder="Country of Origin">
			</div>
			<fieldset>
				<input type="file" name="fileselect" id="fileselect"></input>
				<input id="uploadbutton" type="button" value="Upload to Parse"/>
			</fieldset>
		</form>
		<form class="padded">
			<a class="button button-block" id="submit">Submit</a>
		</form>
        </div>
	
	<!-Footer Bar-> 
        <nav class="bar-tab">
          <ul class="tab-inner">
            <li class="tab-item active">
              <a href="camera.html" data-ajax="false" data-transition="slide-in">
                <img class="tab-icon" src="img/camera.png">
                <div class="tab-label">Camera</div>
              </a>
            </li>
            <li class="tab-item">
              <a href="index.html"  data-ajax="false" data-transition="slide-in">
                <img class="tab-icon" src="img/search.png">
                <div class="tab-label">Search</div>
              </a>
            </li>
            <li class="tab-item">
              <a href="">
                <img class="tab-icon" src="img/settings.png">
                <div class="tab-label">Settings</div>
              </a>
            </li>
          </ul>
        </nav>
        
</body>
</html>
